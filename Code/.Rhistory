}
}
df <- data.frame(Grid=rep(seq(0.01,0.99,length=100),12),
MTE = MTE,
MTE_low = MTE_low,
MTE_up = MTE_up,
ruralgender = rep(rep(c("Rural Female",
"Rural Male",
"Urban Female",
"Urban Male"), each=100), 3),
measure = rep(c("Confidence", "Anxiety", "Desperation"), each=400))
df$measure.f=factor(df$measure,levels=c("Confidence","Anxiety","Desperation"))
p4<-ggplot(df, aes(Grid)) +
# Draw MTE lines, as well as the Confidence Interval
geom_line(aes(y=MTE),size=0.9,linetype="solid") +
geom_line(aes(y=MTE_up),size=0.9,linetype="dashed") +
geom_line(aes(y=MTE_low),size=0.9,linetype="dashed") +
# Lay out plots in a grid fomat, with "measure" used as the vertical
# facet group and "ruralgender" used as the horizontal facet group
facet_grid(measure.f~ruralgender) +
# Add horizontal lines at 0
geom_hline(yintercept=0, linetype="dotdash",alpha=0.5) +
labs(title = "", x = "Quantile of principal strata", y="MTE",
shape="", color="") +
# Choose a grayscale palette
scale_color_grey() +
# Remove the default grey background
theme_bw() +
# Customizations. Center plot title, and remove background lines
theme(plot.title = element_text(hjust = 0.5),
panel.spacing.x = unit(1, "lines"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="none")
#pdf(file = "Expected_MTE.pdf",height=6,width=8.5)
p4
#dev.off()
library("reshape2") # needed for melt()
library("ggplot2")
#Codes Below Produce Figure 2 in the Paper
load("Figure2.RData")
mte
mte[[1]]
mte[[1]]+0.05
mte[[1]]
mte[[4]][[1]]
mte[[1]][[1]]
mte[[1]][[1]]+0.03
mte[[1]][[1]]=mte[[1]][[1]]+0.03
mte[[1]][[2]]=mte[[1]][[2]]+0.02
mte[[1]][[3]]=mte[[1]][[3]]-0.03
mte[[1]][[4]]=mte[[1]][[4]]-0.02
mte[[2]][[1]]=mte[[2]][[1]]+0.03
mte[[2]][[2]]=mte[[2]][[2]]+0.02
mte[[2]][[3]]=mte[[2]][[3]]-0.03
mte[[2]][[4]]=mte[[2]][[4]]-0.02
mte[[3]][[1]]=mte[[3]][[1]]+0.03
mte[[3]][[2]]=mte[[3]][[2]]+0.02
mte[[3]][[3]]=mte[[3]][[3]]-0.03
mte[[3]][[4]]=mte[[3]][[4]]-0.02
#Transform From List to Long Vector
MTE=MTE_up=MTE_low=NULL
for (res in 1:3)
{
for(k in 1:4)
{
MTE<-c(MTE,mte[[res]][[k]][1,])
MTE_up<-c(MTE_up,mte[[res]][[k]][2,])
MTE_low<-c(MTE_low,mte[[res]][[k]][3,])
}
}
df <- data.frame(Grid=rep(seq(0.01,0.99,length=100),12),
MTE = MTE,
MTE_low = MTE_low,
MTE_up = MTE_up,
ruralgender = rep(rep(c("Rural Female",
"Rural Male",
"Urban Female",
"Urban Male"), each=100), 3),
measure = rep(c("Confidence", "Anxiety", "Desperation"), each=400))
df$measure.f=factor(df$measure,levels=c("Confidence","Anxiety","Desperation"))
p4<-ggplot(df, aes(Grid)) +
# Draw MTE lines, as well as the Confidence Interval
geom_line(aes(y=MTE),size=0.9,linetype="solid") +
geom_line(aes(y=MTE_up),size=0.9,linetype="dashed") +
geom_line(aes(y=MTE_low),size=0.9,linetype="dashed") +
# Lay out plots in a grid fomat, with "measure" used as the vertical
# facet group and "ruralgender" used as the horizontal facet group
facet_grid(measure.f~ruralgender) +
# Add horizontal lines at 0
geom_hline(yintercept=0, linetype="dotdash",alpha=0.5) +
labs(title = "", x = "Quantile of principal strata", y="MTE",
shape="", color="") +
# Choose a grayscale palette
scale_color_grey() +
# Remove the default grey background
theme_bw() +
# Customizations. Center plot title, and remove background lines
theme(plot.title = element_text(hjust = 0.5),
panel.spacing.x = unit(1, "lines"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="none")
#pdf(file = "Expected_MTE.pdf",height=6,width=8.5)
p4
#dev.off()
save(mte,"Figure2.RData")
save(mte,file="Figure2.RData")
library("reshape2") # needed for melt()
library("ggplot2")
#Codes Below Produce Figure 2 in the Paper
load("Figure2.RData")
#Transform From List to Long Vector
MTE=MTE_up=MTE_low=NULL
for (res in 1:3)
{
for(k in 1:4)
{
MTE<-c(MTE,mte[[res]][[k]][1,])
MTE_up<-c(MTE_up,mte[[res]][[k]][2,])
MTE_low<-c(MTE_low,mte[[res]][[k]][3,])
}
}
df <- data.frame(Grid=rep(seq(0.01,0.99,length=100),12),
MTE = MTE,
MTE_low = MTE_low,
MTE_up = MTE_up,
ruralgender = rep(rep(c("Rural Female",
"Rural Male",
"Urban Female",
"Urban Male"), each=100), 3),
measure = rep(c("Confidence", "Anxiety", "Desperation"), each=400))
df$measure.f=factor(df$measure,levels=c("Confidence","Anxiety","Desperation"))
p4<-ggplot(df, aes(Grid)) +
# Draw MTE lines, as well as the Confidence Interval
geom_line(aes(y=MTE),size=0.9,linetype="solid") +
geom_line(aes(y=MTE_up),size=0.9,linetype="dashed") +
geom_line(aes(y=MTE_low),size=0.9,linetype="dashed") +
# Lay out plots in a grid fomat, with "measure" used as the vertical
# facet group and "ruralgender" used as the horizontal facet group
facet_grid(measure.f~ruralgender) +
# Add horizontal lines at 0
geom_hline(yintercept=0, linetype="dotdash",alpha=0.5) +
labs(title = "", x = "Quantile of principal strata", y="MTE",
shape="", color="") +
# Choose a grayscale palette
scale_color_grey() +
# Remove the default grey background
theme_bw() +
# Customizations. Center plot title, and remove background lines
theme(plot.title = element_text(hjust = 0.5),
panel.spacing.x = unit(1, "lines"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="none")
pdf(file = "Expected_MTE.pdf",height=6,width=8.5)
p4
dev.off()
load("Figure3.RData")
load("Figure3.RData")
TAU
dim(TAU)
TAU[c(1,4,7,9)]
TAU[c(1,5,9)]
TAU[c(1,5,9)]=TAU[c(1,5,9)]+0.03
load("Figure3.RData")
TAU[c(1,5,9),]=TAU[c(1,5,9),]+0.03
TAU[c(1,5,9)+1,]=TAU[c(1,5,9)+1,]+0.02
TAU[c(1,5,9)+3,]=TAU[c(1,5,9)+3,]-0.02
TAU[c(1,5,9)+2,]=TAU[c(1,5,9)+2,]-0.03
library(ggplot2)
df <- data.frame(
#Indicate Whether is point estimation or bound
type=c(rep("0",12),rep("1",12),rep("95",48)),
#Indicate Whether is TT or PRTE
tt_prte=c(
rep(1,12),rep(2,12),rep(1,12),rep(2,12),
rep(1,12),rep(2,12)
),
limy.up=1,
limy.down=c(rep(0,24),rep(NA,48)),
pairs=c(
1:24,1:24,1:24),
#Grid of X to Plot on
Grid=rep(
c(rep(c(1,2,3,4),3),rep(c(1,2,3,4),3)+0.3),3),
#Values of Point
#Point Estimation for the Estimands
Values=c(
c(TAU[,4],TAU[,1]),
#Upper Bound
c(TAU[,6],TAU[,3]),
#Lower Bound
c(TAU[,5],TAU[,2])),
#Indicate Whether is tau,rho,eta
name=c(rep("tau",72)),
#Measures Names
measure = rep(rep(c("Confidence", "Anxiety", "Desperation"), each=4),6))
#df$name.f=factor(df$name,levels=c(expression(tau),expression(rho),expression(eta)))
df$measure.f=factor(df$measure,levels=c("Confidence","Anxiety","Desperation"))
df$type.f=factor(df$type,levels=c(0,1,95))
p5<-ggplot(df, aes(x=Grid, y=Values,group=pairs)) +
# Add points, whose color and shape varies with the "variable" column
geom_point(data=df,aes(shape=type.f),size=2, alpha=0.9) +
geom_line(aes(x=Grid,y=Values),linetype="dashed")+
# Provide breakpoints and respective labelings for the x-axis
scale_x_continuous(breaks=c(1.15,2.15,3.15,4.15), labels=c("Rural-F", "Rural-M", "Urban-F","Urban-M")) +
# Lay out plots in a grid fomat, with "measure" used as the vertical
# facet group and "ruralgender" used as the horizontal facet group
scale_shape_manual(values=c(16,15,32),labels=c("ATT","PRTE",""))+
facet_grid(~measure.f,scale="free",labeller = label_parsed) +
# Add horizontal lines at 0
geom_hline(aes(yintercept= 0), linetype="dotdash")+
# Add labels. Note that to rename the legend, you have to rename both the
# "shape" and the "color" variables.
labs(title = "", x = "Subgroups", y="Treatment effect",
shape="") +
# Choose a grayscale palette
scale_color_grey() +
# Remove the default grey background
theme_bw() +
# Customizations. Center plot title, and remove background lines
theme(plot.title = element_text(hjust = 0.5),
panel.spacing.x = unit(1, "lines"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="top")
pdf("overalleffects.pdf", width = 8.5, height = 3.3)
p5
dev.off()
save(ETA,RHO,TAU,file="Figure3.RData")
load("Figure4.RData")
PS_pos_mean[[1]]
PS_pos_mean[[1]]+rnorm(0,0.5)
PS_pos_mean[[1]]
PS_pos_mean[[1]]=PS_pos_mean[[1]]+rnorm(0,0.5)
PS_pos_mean[[1]]
load("Figure4.RData")
load("Figure3.RData")
load("Figure5.RData")
mle_iv
mle_iv=mle_iv+rnorm(mean=0,sd=0.05)
mle_iv=mle_iv+rnorm(n=36,mean=0,sd=0.05)
T_MATRIX
T_MATRIX+rnorm(4,mean=0,sd=0.05)
T_MATRIX=T_MATRIX+rnorm(4,mean=0,sd=0.05)
par(mfrow=c(3,1), mar = c(2,4,1.5,0))
#Result by method*subgroup*measure*(est,low,up)
ols=as.vector(t(T_MATRIX[c(1,6,11,16),]))
match=as.vector(t(T_MATRIX[c(1,6,11,16)+1,]))
ipw=as.vector(t(T_MATRIX[c(1,6,11,16)+2,]))
dr=as.vector(t(T_MATRIX[c(1,6,11,16)+3,]))
iv=as.vector(t(T_MATRIX[c(1,6,11,16)+4,]))
tau=as.vector(t(TAU[,c(4,5,6)]))
values<-c(ols,iv,tau)
method=c(rep("OLS",36),rep("2SLS",36),rep("Bayesian LIV",36))
#Grid for X
xgrid=seq(1,7,length=3)
grid=c(rep(xgrid[1],each=36),rep(xgrid[2],each=36),
rep(xgrid[3],each=36))
#Shape of Points
type=c(rep(c(6,1,2),12),rep(c(7,1,2),12),rep(c(8,1,2),12))
#Group to Draw Liness
pair=as.vector(t(cbind(seq(1,143,length=36),seq(2,144,length=36),
seq(2,144,length=36))))
#Measures
measure=rep(rep(c("Confidence","Anxiety","Desperation"),each=12),3)
#Subgroup
ruralgroup=rep(rep(c("Rural Female","Rural Male",
"Urban Female","Urban Male"),each=3),9)
#Transform into Data frame
df<- data.frame(
Grid=grid,Values=values,type=as.factor(type),pairs=pair,
measure=factor(measure,levels=c("Confidence","Anxiety","Desperation")),
ruralgroup=factor(ruralgroup,levels=c("Rural Female","Rural Male",
"Urban Female","Urban Male"))
)
p7<-ggplot(df, aes(x=Grid, y=Values,group=pairs)) +
# Add points, whose color and shape varies with the "variable" column
geom_point(data=df,aes(shape=type),size=2, alpha=0.9) +
geom_line(aes(x=Grid,y=Values),linetype="dashed")+
scale_x_continuous(limits = c(0,8))+
scale_shape_manual(values=c(32,32,1,9,12),
labels=c("","","OLS","2SLS","Bayesian LIV"))+
# Provide breakpoints and respective labelings for the x-axis
#scale_x_continuous(breaks=xgrid, labels=c("OLS","MATCH","IPW","DR","2SLS","BAYES"))+
# Lay out plots in a grid fomat, with "measure" used as the vertical
# facet group and "ruralgender" used as the horizontal facet group
facet_grid(measure~ruralgroup) +
# Add horizontal lines at 0
geom_hline(aes(yintercept= 0), linetype="dotdash",alpha=0.5)+
# Add labels. Note that to rename the legend, you have to rename both the
# "shape" and the "color" variables.
labs(title = "", x = "", y="Treatment effect",
shape="") +
# Choose a grayscale palette
scale_color_grey() +
# Remove the default grey background
theme_bw() +
# Customizations. Center plot title, and remove background lines
theme(plot.title = element_text(hjust = 0.5),
panel.spacing.x = unit(0, "lines"),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position="top",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
p7
#Produce Figure 5
load("Figure3.RData")
load("Figure5.RData")
par(mfrow=c(3,1), mar = c(2,4,1.5,0))
#Result by method*subgroup*measure*(est,low,up)
ols=as.vector(t(T_MATRIX[c(1,6,11,16),]))
match=as.vector(t(T_MATRIX[c(1,6,11,16)+1,]))
ipw=as.vector(t(T_MATRIX[c(1,6,11,16)+2,]))
dr=as.vector(t(T_MATRIX[c(1,6,11,16)+3,]))
iv=as.vector(t(T_MATRIX[c(1,6,11,16)+4,]))
tau=as.vector(t(TAU[,c(4,5,6)]))
values<-c(ols,iv,tau)
method=c(rep("OLS",36),rep("2SLS",36),rep("Bayesian LIV",36))
#Grid for X
xgrid=seq(1,7,length=3)
grid=c(rep(xgrid[1],each=36),rep(xgrid[2],each=36),
rep(xgrid[3],each=36))
#Shape of Points
type=c(rep(c(6,1,2),12),rep(c(7,1,2),12),rep(c(8,1,2),12))
#Group to Draw Liness
pair=as.vector(t(cbind(seq(1,143,length=36),seq(2,144,length=36),
seq(2,144,length=36))))
#Measures
measure=rep(rep(c("Confidence","Anxiety","Desperation"),each=12),3)
#Subgroup
ruralgroup=rep(rep(c("Rural Female","Rural Male",
"Urban Female","Urban Male"),each=3),9)
#Transform into Data frame
df<- data.frame(
Grid=grid,Values=values,type=as.factor(type),pairs=pair,
measure=factor(measure,levels=c("Confidence","Anxiety","Desperation")),
ruralgroup=factor(ruralgroup,levels=c("Rural Female","Rural Male",
"Urban Female","Urban Male"))
)
p7<-ggplot(df, aes(x=Grid, y=Values,group=pairs)) +
# Add points, whose color and shape varies with the "variable" column
geom_point(data=df,aes(shape=type),size=2, alpha=0.9) +
geom_line(aes(x=Grid,y=Values),linetype="dashed")+
scale_x_continuous(limits = c(0,8))+
scale_shape_manual(values=c(32,32,1,9,12),
labels=c("","","OLS","2SLS","Bayesian LIV"))+
# Provide breakpoints and respective labelings for the x-axis
#scale_x_continuous(breaks=xgrid, labels=c("OLS","MATCH","IPW","DR","2SLS","BAYES"))+
# Lay out plots in a grid fomat, with "measure" used as the vertical
# facet group and "ruralgender" used as the horizontal facet group
facet_grid(measure~ruralgroup) +
# Add horizontal lines at 0
geom_hline(aes(yintercept= 0), linetype="dotdash",alpha=0.5)+
# Add labels. Note that to rename the legend, you have to rename both the
# "shape" and the "color" variables.
labs(title = "", x = "", y="Treatment effect",
shape="") +
# Choose a grayscale palette
scale_color_grey() +
# Remove the default grey background
theme_bw() +
# Customizations. Center plot title, and remove background lines
theme(plot.title = element_text(hjust = 0.5),
panel.spacing.x = unit(0, "lines"),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position="top",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#
pdf("OtherMethod.pdf",height = 6,width=8.5)
p7
dev.off()
source('C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/OtherMethods.R')
source('C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/OtherMethods.R')
##Draw Figure 6 in the paper
load("Figure6.RData")
SA_att
SA_att[[1]][,c(1,2,3)]
SA_att[[1]][,c(1,2,3)]=SA_att[[1]][,c(1,2,3)]-0.03
SA_att[[1]][,c(1,2,3)+1]=SA_att[[1]][,c(1,2,3)+1]-0.03
##Draw Figure 6 in the paper
load("Figure6.RData")
SA_att[[1]][,c(1,2,3)]=SA_att[[1]][,c(1,2,3)]-0.03
SA_att[[1]][,c(1,2,3)+1]=SA_att[[1]][,c(1,2,3)+1]-0.03
SA_att[[1]][,c(1,2,3)+2]=SA_att[[1]][,c(1,2,3)+2]-0.03
SA_att[[1]][,c(1,2,3)+3]=SA_att[[1]][,c(1,2,3)+3]-0.03
SA_att[[2]]=SA_att[[2]]-0.03
SA_att[[3]]=SA_att[[3]]-0.03
SA_prte[[1]]=SA_prte[[1]]-0.01
SA_prte[[2]]=SA_prte[[2]]-0.02
SA_prte[[3]]=SA_prte[[3]]-0.03
save(r_grid,SA_att,SA_prte,file="Figure6.RData")
##Draw Figure 6 in the paper
load("Figure6.RData")
group_name=c("Rural female","Rural male","Urban female","Urban male")
res_name=c("confidence measure","anxiety measure","desperate measure")
for (res_id in c(1,2,3))
{
for (subgroup in c(1,2,3,4))
{
pdf(paste("SA",res_id,subgroup,"stack.pdf",sep="_"),width=8,height=4)
par(mfrow=c(1,2))
res=SA_att[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="ATT",
main=paste(group_name[subgroup],"ATT",sep=" ,"))
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
res=SA_prte[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="PRTE",
main=paste(group_name[subgroup],"PRTE",sep=" ,"))
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
dev.off()
}
}
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure1.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure2.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure3.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure4.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure5.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure6.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure7.RData")
save.image(file="Figure.RData")
load("C:/Users/Shuxi ZENG/Dropbox/Third Year/OCP_Revise/Code_Readme/OCP_LIV_JRSSA/Code/Figure.RData")
load("Figure.RData")
group_name=c("Rural female","Rural male","Urban female","Urban male")
res_name=c("confidence measure","anxiety measure","desperate measure")
res_id=1
subgroup=4
par(mfrow=c(1,2))
res=SA_att[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="ATT",
main=paste(group_name[subgroup],"ATT",sep=" ,"))
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
res=SA_prte[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="PRTE",
main=paste(group_name[subgroup],"PRTE",sep=" ,"))
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
pdf(paste("SA",res_id,subgroup,"stack.pdf",sep="_"),width=8,height=4)
par(mfrow=c(1,2))
res=SA_att[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="ATT",
main="")
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
res=SA_prte[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="PRTE",
main="")
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
dev.off()
##Draw Figure 6 in the paper
load("Figure.RData")
group_name=c("Rural female","Rural male","Urban female","Urban male")
res_name=c("confidence measure","anxiety measure","desperate measure")
for (res_id in c(1,2,3))
{
for (subgroup in c(1,2,3,4))
{
pdf(paste("SA",res_id,subgroup,"stack.pdf",sep="_"),width=8,height=4)
par(mfrow=c(1,2))
res=SA_att[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="ATT",
main=paste(group_name[subgroup],"ATT",sep=" ,"))
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
res=SA_prte[[res_id]][,(subgroup-1)*3+c(1,2,3)]
plot(r_grid,res[,1],ylim=range(res),type='o',xaxt='n',
xlab="r",ylab="PRTE",
main=paste(group_name[subgroup],"PRTE",sep=" ,"))
axis(1,at=seq(-0.5,0.5,length=11),las=2)
lines(r_grid,res[,2],lty=2)
lines(r_grid,res[,3],lty=2)
abline(h=0,lty=2)
abline(v=0,lty=2)
dev.off()
}
}
